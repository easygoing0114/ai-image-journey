"use strict";(this.webpackChunkmermaid=this.webpackChunkmermaid||[]).push([[968],{8968:(t,e,a)=>{a.d(e,{diagram:()=>c});var r=a(2633),i=a(8918),n=a(944),d=a(697),o=a(9466);a(4353),a(6750),a(2838);let s=0;const getClassTitleString=function(t){let e=t.id;return t.type&&(e+="<"+(0,o.x)(t.type)+">"),e},addTspan=function(t,e,a,r){const{displayText:i,cssStyle:n}=e.getDisplayDetails(),d=t.append("tspan").attr("x",r.padding).text(i);""!==n&&d.attr("style",e.cssStyle),a||d.attr("dy",r.textHeight)},svgDraw_drawClass=function(t,e,a,r){o.l.debug("Rendering class ",e,a);const i=e.id,n={id:i,label:e.id,width:0,height:0},d=t.append("g").attr("id",r.db.lookUpDomId(i)).attr("class","classGroup");let s;s=e.link?d.append("svg:a").attr("xlink:href",e.link).attr("target",e.linkTarget).append("text").attr("y",a.textHeight+a.padding).attr("x",0):d.append("text").attr("y",a.textHeight+a.padding).attr("x",0);let l=!0;e.annotations.forEach(function(t){const e=s.append("tspan").text("«"+t+"»");l||e.attr("dy",a.textHeight),l=!1});let p=getClassTitleString(e);const c=s.append("tspan").text(p).attr("class","title");l||c.attr("dy",a.textHeight);const g=s.node().getBBox().height;let h,f,x;if(e.members.length>0){h=d.append("line").attr("x1",0).attr("y1",a.padding+g+a.dividerMargin/2).attr("y2",a.padding+g+a.dividerMargin/2);const t=d.append("text").attr("x",a.padding).attr("y",g+a.dividerMargin+a.textHeight).attr("fill","white").attr("class","classText");l=!0,e.members.forEach(function(e){addTspan(t,e,l,a),l=!1}),f=t.node().getBBox()}if(e.methods.length>0){x=d.append("line").attr("x1",0).attr("y1",a.padding+g+a.dividerMargin+f.height).attr("y2",a.padding+g+a.dividerMargin+f.height);const t=d.append("text").attr("x",a.padding).attr("y",g+2*a.dividerMargin+f.height+a.textHeight).attr("fill","white").attr("class","classText");l=!0,e.methods.forEach(function(e){addTspan(t,e,l,a),l=!1})}const u=d.node().getBBox();var y=" ";e.cssClasses.length>0&&(y+=e.cssClasses.join(" "));const m=d.insert("rect",":first-child").attr("x",0).attr("y",0).attr("width",u.width+2*a.padding).attr("height",u.height+a.padding+.5*a.dividerMargin).attr("class",y).node().getBBox().width;return s.node().childNodes.forEach(function(t){t.setAttribute("x",(m-t.getBBox().width)/2)}),e.tooltip&&s.insert("title").text(e.tooltip),h&&h.attr("x2",m),x&&x.attr("x2",m),n.width=m,n.height=u.height+a.padding+.5*a.dividerMargin,n},svgDraw_drawEdge=function(t,e,a,r,n){const getRelationType=function(t){switch(t){case n.db.relationType.AGGREGATION:return"aggregation";case n.db.relationType.EXTENSION:return"extension";case n.db.relationType.COMPOSITION:return"composition";case n.db.relationType.DEPENDENCY:return"dependency";case n.db.relationType.LOLLIPOP:return"lollipop"}};e.points=e.points.filter(t=>!Number.isNaN(t.y));const d=e.points,l=(0,i.n8j)().x(function(t){return t.x}).y(function(t){return t.y}).curve(i.qrM),p=t.append("path").attr("d",l(d)).attr("id","edge"+s).attr("class","relation");let c,g,h="";r.arrowMarkerAbsolute&&(h=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,h=h.replace(/\(/g,"\\("),h=h.replace(/\)/g,"\\)")),1==a.relation.lineType&&p.attr("class","relation dashed-line"),10==a.relation.lineType&&p.attr("class","relation dotted-line"),"none"!==a.relation.type1&&p.attr("marker-start","url("+h+"#"+getRelationType(a.relation.type1)+"Start)"),"none"!==a.relation.type2&&p.attr("marker-end","url("+h+"#"+getRelationType(a.relation.type2)+"End)");const f=e.points.length;let x,u,y,m,b=o.u.calcLabelPosition(e.points);if(c=b.x,g=b.y,f%2!=0&&f>1){let t=o.u.calcCardinalityPosition("none"!==a.relation.type1,e.points,e.points[0]),r=o.u.calcCardinalityPosition("none"!==a.relation.type2,e.points,e.points[f-1]);o.l.debug("cardinality_1_point "+JSON.stringify(t)),o.l.debug("cardinality_2_point "+JSON.stringify(r)),x=t.x,u=t.y,y=r.x,m=r.y}if(void 0!==a.title){const e=t.append("g").attr("class","classLabel"),i=e.append("text").attr("class","label").attr("x",c).attr("y",g).attr("fill","red").attr("text-anchor","middle").text(a.title);window.label=i;const n=i.node().getBBox();e.insert("rect",":first-child").attr("class","box").attr("x",n.x-r.padding/2).attr("y",n.y-r.padding/2).attr("width",n.width+r.padding).attr("height",n.height+r.padding)}if(o.l.info("Rendering relation "+JSON.stringify(a)),void 0!==a.relationTitle1&&"none"!==a.relationTitle1){t.append("g").attr("class","cardinality").append("text").attr("class","type1").attr("x",x).attr("y",u).attr("fill","black").attr("font-size","6").text(a.relationTitle1)}if(void 0!==a.relationTitle2&&"none"!==a.relationTitle2){t.append("g").attr("class","cardinality").append("text").attr("class","type2").attr("x",y).attr("y",m).attr("fill","black").attr("font-size","6").text(a.relationTitle2)}s++},svgDraw_drawNote=function(t,e,a,r){o.l.debug("Rendering note ",e,a);const i=e.id,n={id:i,text:e.text,width:0,height:0},d=t.append("g").attr("id",i).attr("class","classGroup");let s=d.append("text").attr("y",a.textHeight+a.padding).attr("x",0);const l=JSON.parse(`"${e.text}"`).split("\n");l.forEach(function(t){o.l.debug(`Adding line: ${t}`),s.append("tspan").text(t).attr("class","title").attr("dy",a.textHeight)});const p=d.node().getBBox(),c=d.insert("rect",":first-child").attr("x",0).attr("y",0).attr("width",p.width+2*a.padding).attr("height",p.height+l.length*a.textHeight+a.padding+.5*a.dividerMargin).node().getBBox().width;return s.node().childNodes.forEach(function(t){t.setAttribute("x",(c-t.getBBox().width)/2)}),n.width=c,n.height=p.height+l.length*a.textHeight+a.padding+.5*a.dividerMargin,n};let l={};const getGraphId=function(t){const e=Object.entries(l).find(e=>e[1].label===t);if(e)return e[0]},p={draw:function(t,e,a,r){const s=(0,o.c)().class;l={},o.l.info("Rendering diagram "+t);const p=(0,o.c)().securityLevel;let c;"sandbox"===p&&(c=(0,i.Ltv)("#i"+e));const g="sandbox"===p?(0,i.Ltv)(c.nodes()[0].contentDocument.body):(0,i.Ltv)("body"),h=g.select(`[id='${e}']`);var f;(f=h).append("defs").append("marker").attr("id","extensionStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),f.append("defs").append("marker").attr("id","extensionEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z"),f.append("defs").append("marker").attr("id","compositionStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),f.append("defs").append("marker").attr("id","compositionEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),f.append("defs").append("marker").attr("id","aggregationStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),f.append("defs").append("marker").attr("id","aggregationEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),f.append("defs").append("marker").attr("id","dependencyStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),f.append("defs").append("marker").attr("id","dependencyEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z");const x=new d.T({multigraph:!0});x.setGraph({isMultiGraph:!0}),x.setDefaultEdgeLabel(function(){return{}});const u=r.db.getClasses(),y=Object.keys(u);for(const t of y){const e=u[t],a=svgDraw_drawClass(h,e,s,r);l[a.id]=a,x.setNode(a.id,a),o.l.info("Org height: "+a.height)}r.db.getRelations().forEach(function(t){o.l.info("tjoho"+getGraphId(t.id1)+getGraphId(t.id2)+JSON.stringify(t)),x.setEdge(getGraphId(t.id1),getGraphId(t.id2),{relation:t},t.title||"DEFAULT")});r.db.getNotes().forEach(function(t){o.l.debug(`Adding note: ${JSON.stringify(t)}`);const e=svgDraw_drawNote(h,t,s,r);l[e.id]=e,x.setNode(e.id,e),t.class&&t.class in u&&x.setEdge(t.id,getGraphId(t.class),{relation:{id1:t.id,id2:t.class,relation:{type1:"none",type2:"none",lineType:10}}},"DEFAULT")}),(0,n.Zp)(x),x.nodes().forEach(function(t){void 0!==t&&void 0!==x.node(t)&&(o.l.debug("Node "+t+": "+JSON.stringify(x.node(t))),g.select("#"+(r.db.lookUpDomId(t)||t)).attr("transform","translate("+(x.node(t).x-x.node(t).width/2)+","+(x.node(t).y-x.node(t).height/2)+" )"))}),x.edges().forEach(function(t){void 0!==t&&void 0!==x.edge(t)&&(o.l.debug("Edge "+t.v+" -> "+t.w+": "+JSON.stringify(x.edge(t))),svgDraw_drawEdge(h,x.edge(t),x.edge(t).relation,s,r))});const m=h.node().getBBox(),b=m.width+40,k=m.height+40;(0,o.i)(h,k,b,s.useMaxWidth);const w=`${m.x-20} ${m.y-20} ${b} ${k}`;o.l.debug(`viewBox ${w}`),h.attr("viewBox",w)}},c={parser:r.p,db:r.d,renderer:p,styles:r.s,init:t=>{t.class||(t.class={}),t.class.arrowMarkerAbsolute=t.arrowMarkerAbsolute,r.d.clear()}}}}]);